"use strict";(self["webpackChunkdev"]=self["webpackChunkdev"]||[]).push([[4717],{5815:function(t,e,s){s.r(e),s.d(e,{default:function(){return f}});var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"request"},[e("header",{attrs:{flex:"",jsb:"",ac:""}},[e("div",{attrs:{flex:""}},[e("btn",{attrs:{flat:"",blue:"",bg:"",sm:"","pl-sm":"","pr-lg":"","ht-3":"",tile:"","mr-xl":"",disabled:!t.stat.create},on:{click:function(e){return t.$refs.formset.dispatch("create")}}},[e("i",{attrs:{xl:"","nu-md":"","wd-1":""}},[t._v("＋")]),e("i",{attrs:{"nu-xs":""}},[t._v("新增")])]),e("btn",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.devOption.qualityControl.requestDeletable&&!t.stat.selecting,expression:"$store.state.devOption.qualityControl.requestDeletable && !stat.selecting"}],attrs:{flat:"",blue:"",bg:"",sm:"","pl-sm":"","pr-lg":"","ht-3":"",tile:"","mr-xl":"",disabled:!t.stat.create},on:{click:function(e){t.$refs.formset.dispatch("toggleSelect"),t.toggleSelect()}}},[e("ico",{attrs:{"ml-sm":"","mr-xs":"",md:"","nu-xs":""}},[t._v("cbrankic-hecked")]),e("i",{attrs:{"nu-xs":""}},[t._v("选择")])],1),e("btn",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.devOption.qualityControl.requestDeletable&&t.stat.selecting,expression:"$store.state.devOption.qualityControl.requestDeletable && stat.selecting"}],attrs:{flat:"",blue:"",outlined:"",sm:"","pl-sm":"","pr-lg":"","ht-3":"",tile:"","mr-xl":"",disabled:!t.stat.create},on:{click:function(e){t.$refs.formset.dispatch("toggleSelect"),t.toggleSelect()}}},[e("ico",{attrs:{"ml-sm":"","mr-xs":"",md:"","nu-xs":""}},[t._v("brankic-error")]),e("i",{attrs:{"nu-xs":""}},[t._v("取消")])],1),t.$store.state.devOption.qualityControl.requestDeletable?e("btn",{attrs:{flat:"",red:"",outlined:"",sm:"","pl-sm":"","pr-lg":"","ht-3":"",tile:"","mr-xl":"",disabled:!t.stat.create},on:{click:function(e){return t.$refs.formset.dispatch("deleteSelected")}}},[e("ico",{attrs:{"ml-sm":"","mr-xs":"",sm:"","nu-sm":""}},[t._v("icoMoon-bin")]),e("i",{attrs:{"nu-xs":""}},[t._v("删除")])],1):t._e()],1),e("field",{directives:[{name:"addon",rawName:"v-addon:suffix",value:t.searchIcon,expression:"searchIcon",arg:"suffix"}],staticClass:"searchBox",attrs:{outlined:"",tile:"",xs:"",placeholder:"精确搜索: 请输入日期、名称或功能查找服务"},on:{enter:t.search,clickSearch:t.search},model:{value:t.stat.search,callback:function(e){t.$set(t.stat,"search",e)},expression:"stat.search"}})],1),e("main",{attrs:{catskill:"",lighten:"",bg:"","sm-pa":"","pa-sm":"",flex:"",js:"",card:""}},[e("formset",{ref:"formset",attrs:{"lg-pt":"","pt-lg":"",noselect:!t.requestDeletable,"api:subject":"qualityControl/request/semi/form","api:primary":"requestGuid",columns:t.columns,patch:{tabular:{width:"900px"}}},on:{opened:t.opened,closed:t.closed},scopedSlots:t._u([{key:"form",fn:function(){return[e("div",{staticClass:"sketch210813",attrs:{flex:"",jc:"",loading:t.loading}},[e("div",{staticStyle:{width:"1100px"}},[e("h2",{attrs:{jc:"","xl-ls":"","ls-xl":"","md-mb":"","mb-lg":""}},[t._v("请验单")]),e("table",{attrs:{"xl-mb":"","mb-xl":""}},[e("tr",[e("td",{attrs:{"wd-20":"",bold:"","ls-sm":""}},[e("div",{attrs:{"mx-auto":"","wd-14":"",jj:""}},[t._v("入库暂存单编号")])]),e("td",{attrs:{"wd-20":"",bold:"","ls-sm":"",jc:""}},[t._v("ZC 2019040601")]),e("td",{attrs:{"wd-18":"",bold:"","ls-sm":"",jc:""}},[e("div",{attrs:{"mx-auto":"","wd-11":"",jj:""}},[t._v("请验单编号")])]),e("td",{attrs:{colspan:"3",jc:""}},[t._v(t._s(t.form.requestNum))])]),e("tr",[e("td",{attrs:{bold:"","ls-lg":""}},[e("div",{attrs:{"mx-auto":"","wd-14":"",jj:""}},[t._v("样品编码")])]),e("td",{attrs:{jc:""}},[t._v(t._s(t.form.sampleNum))]),e("td",{attrs:{jc:"","ls-lg":""}},[e("div",{attrs:{"mx-auto":"","wd-11":"",jj:"",bold:""}},[t._v("样品数量")])]),e("td",{attrs:{jc:"",relative:""}},[e("field",{attrs:{relative:"",fill:"",noborder:"",invalid:!t.sampleQuantityEditable},on:{enter:function(e){t.handleSampleQuantity(),t.createSampleTime()}},model:{value:t.form.sampleQuantity,callback:function(e){t.$set(t.form,"sampleQuantity",e)},expression:"form.sampleQuantity"}}),t.form.sampleQuantity?t._e():e("div",{staticClass:"sampleQuantity",attrs:{"ls-sm":"",fill:""}},[t._v(t._s("("+t.suggest.quantity+"g)品控取样后填写"))])],1),e("td",{attrs:{jc:"","ls-lg":"","wd-18":"",bold:""}},[t._v("取样/送样时间")]),e("td",{attrs:{jc:"","ls-sm":"","wd-23":""}},[e("div",{class:{pink:!Boolean(t.form.sampleTime)}},[t._v(t._s(t.form.sampleTime?t.form.sampleTime:"系统带出当天日期"))])])]),e("tr",{attrs:{noselect:""}},[e("td",{attrs:{colspan:"6",md:"",bold:"",jc:"","md-ls":"","ls-xl":""}},[t._v(" 检验项目 ")])]),t._l(t.form.items,(function(s,l){return e("tr",{attrs:{noselect:""}},[e("td",{attrs:{colspan:"6"}},[e("div",{staticClass:"upperBox",attrs:{flex:"",bb:""}},[e("div",{staticClass:"groupName",attrs:{bold:"","ls-lg":""}},[t._v(" "+t._s(t.groupNames[l])+" ")]),e("div",{staticClass:"selectAll"},[e("field",{directives:[{name:"inject",rawName:"v-inject:label",value:"全 选",expression:"'全 选'",arg:"label"},{name:"addon",rawName:"v-addon:prefix",value:t.selectAllBox,expression:"selectAllBox",arg:"prefix"}],class:{immutable:!t.mutable},attrs:{check:"",noborder:"",invalid:!t.mutable},on:{click:function(e){return t.toggleSelectAll(l)}},model:{value:t.selectAll[l],callback:function(e){t.$set(t.selectAll,l,e)},expression:"selectAll[groupIndex]"}})],1)]),e("div",{staticClass:"itemBox",class:{fix:1===l}},t._l(s.list,(function(s,a){return e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckBox,expression:"dotCheckBox",arg:"prefix"},{name:"inject",rawName:"v-inject:label",value:s.label,expression:"item.label",arg:"label"},{name:"inject",rawName:"v-inject:groupIndex",value:l,expression:"groupIndex",arg:"groupIndex"}],class:{immutable:!t.mutable},attrs:{check:"",noborder:"","ml-lg":"",sm:"",invalid:!t.mutable},on:{change:function(e){return t.toggleItem(l,a)}},model:{value:s.valid,callback:function(e){t.$set(s,"valid",e)},expression:"item.valid"}})})),1)])])}))],2),e("div",{attrs:{"xl-mt":"","mt-lg":"","pt-xl":"",flex:"",je:""}},[e("btn",{attrs:{round:"","wd-12":"","xl-mr":"","mr-md":""},on:{click:function(e){return t.form.close()}}},[t._v("取消")]),e("btn",{attrs:{round:"","wd-12":"","xl-mr":"","mr-md":"",invalid:""}},[t._v("暂存")]),e("btn",{attrs:{round:"","wd-12":"","xl-ml":"",blue:"",bg:"",pending:t.pending,disabled:0===t.form.items.length},on:{click:t.submit}},[t._v(" 提交 ")])],1),e("gap",{attrs:{"py-xl":""}})],1)])]},proxy:!0}])})],1)])},a=[],r=s(4374),i=s(6017),n=s(5835),o=s(7920),m=s(4353),u=s.n(m),d={name:"request-semi",mixins:[o["default"]],data(){return{form:{requestGuid:0,requestNum:"",sampleNum:"",templateGuid:1,templateName:"三海",vendorName:"",batchNum:"",sampleQuantity:"",materialName:"半成品",requestTime:"",sampleTime:"",sampler:"",requestStateCode:0,requestTypeIndex:1,items:[]},pending:!1,columns:[{label:"日期",value:"requestTime"},{label:"入库暂存单编号",value:"tempStorageNum",component:n["default"]},{label:"请验单编号",value:"requestNum",component:r.A},{label:"样品编码",value:"sampleNum",component:i.A},{label:"取样人",value:"sampler",width:150}]}},computed:{url(){return{availableRequestNum:"/qualityControl/request/semi/form/availableRequestNum",items:"/qualityControl/template/semi/0/items"}}},methods:{opened(){this.stat.create=!1,this.form.isNew?(this.$http.get(this.url.availableRequestNum).then((t=>{this.form.requestNum="QYB "+t.data,this.form.sampleNum="S "+t.data})),this.$http.get(this.url.items).then((t=>{this.form.items=t.data,this.initSelectAll(),this.loading=!1}))):this.getFormByRequestGuid()},submit(){this.pending=!0,this.form.requestStateCode=this.form.sampleQuantity?1:0,this.form.requestTime||(this.form.requestTime=u()().format("YYYY-MM-DD HH:mm")),this.form.submit().then((t=>{1!==t&&0!==t&&alert("服务器出现问题，请刷新重试"),this.pending=!1}))}}},c=d,p=s(1656),v=(0,p.A)(c,l,a,!1,null,"3f950b40",null),f=v.exports}}]);