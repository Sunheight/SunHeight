"use strict";(self["webpackChunkdev"]=self["webpackChunkdev"]||[]).push([[1406],{7052:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var s=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"slideUp"}},[t.stat.user.valid?e("div",{staticClass:"userManagementCrew",attrs:{catskill:"",lighten:"",bg:"",fill:"",card:"",noselect:""}},[e("header",{staticClass:"bar",attrs:{flex:"",jsb:"",ac:""}},[e("div",{attrs:{"ls-xl":""}},[t._v("添加新成员")]),e("ico",{attrs:{xs:"",pointer:"",bold:""},on:{click:t.close}},[t._v("ui-close")])],1),e("section",{staticClass:"inputBox",class:{activated:"0"===t.stat.user.inputMode},attrs:{"px-xl":"","md-px":"","pt-xl":"",relative:"","z-index-1":""}},[e("field",{attrs:{"ht-6":"",bold:"",xs:"",ac:"","mt-xl":"","nl-xl":"",check:"",cyan:"",noborder:"","nu-xs":"",value:"0"},model:{value:t.stat.user.inputMode,callback:function(e){t.$set(t.stat.user,"inputMode",e)},expression:"stat.user.inputMode"}},[t._v(" 信息手动录入 ")]),e("div",{staticStyle:{"border-bottom":".5px dashed rgba(0,0,0,.2)"}}),e("div",{staticClass:"mask"},[e("div",{staticClass:"manualBox",attrs:{flex:"","ht-23":""}},[e("div",{attrs:{flex:"",column:"",jsb:"",fill:"","col-7":"","pl-lg":"","sm-pl":"","pr-xl":"","xl-pr":""}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{"mt-md":"","sm-mt":"",relative:"",action:"#","http-request":t.httpRequest,"show-file-list":!1,"before-upload":t.beforeAvatarUpload}},[e("imager",{staticClass:"avatar",attrs:{width:"90px",height:"90px",src:t.data.user.portrait}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.data.user.portrait!==t.defaultImg,expression:"data.user.portrait !== defaultImg"}],staticClass:"resetBtn",attrs:{pointer:""},on:{click:function(e){return e.stopPropagation(),t.resetPortrait.apply(null,arguments)}}},[e("ico",{attrs:{sm:"",catskill:"",lighten:""}},[t._v("brankic-error")])],1)],1),e("div",{attrs:{"col-22":""}},[e("div",{attrs:{"ht-2":"","mb-xl":""}},[e("field",{attrs:{fill:"",xs:"",tile:"",label:"姓名"},model:{value:t.data.user.fullName,callback:function(e){t.$set(t.data.user,"fullName",e)},expression:"data.user.fullName"}})],1),e("div",{attrs:{"ht-2":"","mb-xl":""}},[e("field",{attrs:{fill:"",xs:"",tile:"",label:"简称"},model:{value:t.data.user.shortName,callback:function(e){t.$set(t.data.user,"shortName",e)},expression:"data.user.shortName"}})],1),e("div",{attrs:{"ht-2":"",relative:""}},[e("div",{staticStyle:{position:"absolute",left:"-12px",top:"5px"},attrs:{red:""}},[t._v("*")]),e("field",{attrs:{fill:"",xs:"",tile:"",label:"账号",placeholder:"成员唯一标识，设定以后不支持修改"},model:{value:t.data.user.username,callback:function(e){t.$set(t.data.user,"username",e)},expression:"data.user.username"}})],1)])],1),e("div",{attrs:{fill:"",sm:"","col-9":"",flex:"",column:"",jsb:""}},[e("div",{attrs:{"col-25":"",flex:"","mt-xl":"","lg-mt":"","mb-sm":""}},[e("div",{staticClass:"fieldName",attrs:{"wd-6":"","mr-xs":""}},[t._v("性别")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"",flex:"",ac:"","ml-lg":"","pb-sm":""}},[e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckAddon,expression:"dotCheckAddon",arg:"prefix"},{name:"inject",rawName:"v-inject:state",value:{label:"男",value:"0"},expression:"{label:'男',value:'0'}",arg:"state"}],attrs:{check:"","wd-9":"","mr-xl":"",noborder:"",xs:"",tile:"",value:"0"},model:{value:t.data.user.sexIndex,callback:function(e){t.$set(t.data.user,"sexIndex",e)},expression:"data.user.sexIndex"}}),e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckAddon,expression:"dotCheckAddon",arg:"prefix"},{name:"inject",rawName:"v-inject:state",value:{label:"女",value:"1"},expression:"{label:'女',value:'1'}",arg:"state"}],attrs:{check:"","wd-9":"","mr-xl":"",noborder:"",xs:"",tile:"",value:"1"},model:{value:t.data.user.sexIndex,callback:function(e){t.$set(t.data.user,"sexIndex",e)},expression:"data.user.sexIndex"}})],1)]),e("div",{attrs:{"col-25":"",flex:"","mb-sm":""}},[e("div",{staticClass:"fieldName",attrs:{"wd-6":"","mr-xs":""}},[t._v("手机")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"","ml-lg":""}},[e("field",{attrs:{fill:"",xs:"",tile:"",placeholder:"员工通过验证该手机后可加入企业"},model:{value:t.data.user.cellPhone,callback:function(e){t.$set(t.data.user,"cellPhone",e)},expression:"data.user.cellPhone"}})],1)]),e("div",{attrs:{"col-25":"",flex:"","mb-sm":""}},[e("div",{staticClass:"fieldName",attrs:{"wd-6":"","mr-xs":""}},[t._v("座机")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"","ml-lg":""}},[e("field",{attrs:{fill:"",xs:"",tile:""},model:{value:t.data.user.officePhone,callback:function(e){t.$set(t.data.user,"officePhone",e)},expression:"data.user.officePhone"}})],1)]),e("div",{attrs:{"col-25":"",flex:"","mb-sm":""}},[e("div",{staticClass:"fieldName",attrs:{"wd-6":"","mr-xs":""}},[t._v("邮箱")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"","ml-lg":""}},[e("field",{attrs:{fill:"",xs:"",tile:""},model:{value:t.data.user.mail,callback:function(e){t.$set(t.data.user,"mail",e)},expression:"data.user.mail"}})],1)]),e("div",{attrs:{"col-25":"",flex:""}},[e("div",{staticClass:"fieldName",attrs:{"wd-6":"","mr-xs":""}},[t._v("地址")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"","ml-lg":""}},[e("field",{attrs:{fill:"",xs:"",tile:""},model:{value:t.data.user.address,callback:function(e){t.$set(t.data.user,"address",e)},expression:"data.user.address"}})],1)])]),e("div",{attrs:{fill:"",sm:"","col-9":"",flex:"",column:"",jsb:""}},[e("div",{attrs:{"ht-12":"","mb-xs":""}}),e("div",{attrs:{"col-25":"",flex:"","mb-sm":"",relative:""}},[e("div",{staticStyle:{position:"absolute",left:"-12px",top:"2.5px"},attrs:{red:""}},[t._v("*")]),e("div",{staticClass:"fieldName",attrs:{"wd-8":"","mr-xs":""}},[t._v("部门")]),t._v(": "),e("div",{attrs:{"col-10yarn":"","ht-2":"","ml-lg":"",relative:"","z-index-1":""}},[e("field",{attrs:{select:"",fill:"",xs:"",tile:"",placeholder:"请选择部门"},model:{value:t.data.user.deptName,callback:function(e){t.$set(t.data.user,"deptName",e)},expression:"data.user.deptName"}},t._l(t.data.tree.companys,(function(a,s){return e("div",{staticClass:"selectSlot"},[e("div",{staticClass:"company item",on:{click:function(e){return t.select(a)}}},[t._v(t._s(a.name))]),t._l(a.children,(function(a,s){return e("div",[e("div",{staticClass:"dept item",on:{click:function(e){return t.select(a)}}},[t._v(t._s(a.name))]),t._l(a.children,(function(a,s){return e("div",[e("div",{staticClass:"subDept item",on:{click:function(e){return t.select(a)}}},[t._v(t._s(a.name))])])}))],2)}))],2)})),0)],1)]),e("div",{attrs:{"col-25":"",flex:"","mb-sm":""}},[e("div",{staticClass:"fieldName",attrs:{"wd-8":"","mr-xs":""}},[t._v("职务")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"","ml-lg":""}},[e("field",{attrs:{fill:"",xs:"",tile:""},model:{value:t.data.user.position,callback:function(e){t.$set(t.data.user,"position",e)},expression:"data.user.position"}})],1)]),e("div",{attrs:{"col-25":"",flex:"","mb-sm":""}},[e("div",{staticClass:"fieldName",attrs:{"wd-8":"","mr-xs":""}},[t._v("直接上级")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"","ml-lg":""}},[e("field",{attrs:{fill:"",xs:"",tile:""},model:{value:t.data.user.superiorName,callback:function(e){t.$set(t.data.user,"superiorName",e)},expression:"data.user.superiorName"}})],1)]),e("div",{attrs:{"col-25":"",flex:""}},[e("div",{staticClass:"fieldName",attrs:{"wd-8":"","mr-xs":""}},[t._v("身份")]),t._v(": "),e("div",{attrs:{"col-19":"","ht-2":"",flex:"",ac:"","ml-lg":"","pb-sm":""}},[e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckAddon,expression:"dotCheckAddon",arg:"prefix"},{name:"inject",rawName:"v-inject:state",value:{label:"员工",value:"0"},expression:"{label:'员工',value:'0'}",arg:"state"}],attrs:{check:"","wd-9":"","mr-xl":"",noborder:"",xs:"",tile:"",value:"0"},model:{value:t.data.user.roleIndex,callback:function(e){t.$set(t.data.user,"roleIndex",e)},expression:"data.user.roleIndex"}}),e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckAddon,expression:"dotCheckAddon",arg:"prefix"},{name:"inject",rawName:"v-inject:state",value:{label:"主管",value:"1"},expression:"{label:'主管',value:'1'}",arg:"state"}],attrs:{check:"","wd-9":"","mr-xl":"",noborder:"",xs:"",tile:"",value:"1"},model:{value:t.data.user.roleIndex,callback:function(e){t.$set(t.data.user,"roleIndex",e)},expression:"data.user.roleIndex"}}),e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckAddon,expression:"dotCheckAddon",arg:"prefix"},{name:"inject",rawName:"v-inject:state",value:{label:"经理",value:"2"},expression:"{label:'经理',value:'2'}",arg:"state"}],attrs:{check:"","wd-9":"","mr-xl":"",noborder:"",xs:"",tile:"",value:"2"},model:{value:t.data.user.roleIndex,callback:function(e){t.$set(t.data.user,"roleIndex",e)},expression:"data.user.roleIndex"}}),e("field",{directives:[{name:"addon",rawName:"v-addon:prefix",value:t.dotCheckAddon,expression:"dotCheckAddon",arg:"prefix"},{name:"inject",rawName:"v-inject:state",value:{label:"高管",value:"3"},expression:"{label:'高管',value:'3'}",arg:"state"}],attrs:{check:"","wd-9":"","mr-xl":"",noborder:"",xs:"",tile:"",value:"3"},model:{value:t.data.user.roleIndex,callback:function(e){t.$set(t.data.user,"roleIndex",e)},expression:"data.user.roleIndex"}})],1)])])]),e("div",{attrs:{fill:"","ht-3":""}})])],1),e("section",{staticClass:"inputBox",class:{activated:"1"===t.stat.user.inputMode},attrs:{"px-xl":"","md-px":""}},[e("field",{attrs:{"ht-6":"",bold:"",xs:"",ac:"","mt-xl":"","nl-xl":"",check:"",cyan:"",noborder:"","nu-xs":"",value:"1"},model:{value:t.stat.user.inputMode,callback:function(e){t.$set(t.stat.user,"inputMode",e)},expression:"stat.user.inputMode"}},[t._v(" 信息导入 ")]),e("div",{staticClass:"mask"},[e("div",{staticStyle:{"border-bottom":".5px dashed rgba(0,0,0,.2)"}}),e("div",{attrs:{flex:"",ac:"","my-md":"","md-my":"",relative:"","z-index-1":""}},[e("i",{attrs:{cyan:"",sm:"",bold:"","mx-xs":"","nu-sm":""}},[t._v("●")]),e("i",{attrs:{sm:"",black:"","mr-sm":""}},[t._v("导入类型")]),e("field",{attrs:{select:"",cyan:"","ht-1":"",tile:"",xs:"",items:["新增","变更"]},on:{select:t.selectImportType},model:{value:t.importData.typeName,callback:function(e){t.$set(t.importData,"typeName",e)},expression:"importData.typeName"}})],1),e("div",{attrs:{flex:"",ac:"","my-md":"","md-my":""}},[e("i",{attrs:{cyan:"",sm:"",bold:"","mx-xs":"","nu-sm":""}},[t._v("●")]),e("i",{attrs:{sm:"",black:"","mr-sm":""}},[t._v("选择文件")]),e("div",{attrs:{border:"","ht-xs":"","xl-wd":"","wd-md":"",grey:"",lighten:"",jc:"",ac:"",pointer:""}},[e("i",{attrs:{xs:"",cyan:"","nu-sm":""}},[t._v("导入模板（选择导入模板无需填写上述内容）")])])]),e("div",{attrs:{flex:"",ac:""}},[e("i",{attrs:{cyan:"",sm:"",bold:"","mx-xs":"","nu-sm":""}},[t._v("●")]),e("i",{attrs:{sm:"",black:"","wd-10":""}},[t._v("导入说明")]),e("div",{staticStyle:{"border-bottom":".5px dashed rgba(0,0,0,.2)"},attrs:{fill:""}})]),e("div",{attrs:{flex:"","mt-lg":""}},[e("div",{attrs:{"xs-px":"","px-xl":""}},[e("ol",{attrs:{flex:"",column:"",wrap:""}},[e("li",[t._v("选择文件："),e("i",{attrs:{pointer:"",cyan:""}},[t._v("导入模板")])]),e("li",[t._v("填写模板数据后将文件上传。")]),e("li",[t._v("基本信息固定字段和自定义字段、个人信息主表字段和自定义字段、 工作信息主表字段和自定义字段可以通过模板导入。 ")]),e("li",[t._v(" 新增的自定义字段导入时，需在导入模板原有列之后新增，列名与该自定义字段名称相同即可导入。 ")]),e("li",[t._v(" 人员数据必须填入导入模板的第二个 sheet 中，导入模板中第 1、2 行为固定行，不能填写人员数据， 数据从第三行开始填写，中间不能有空行。 ")]),e("li",[t._v(" 导入模板中，分部和部门的列位置不能改变，红色背景列为必填列，其他为非必填列，非必填列可不填或删除，同时确保 Excel 模板中的列名不重复。 ")]),e("li",[t._v(" 重复验证字段说明：判断 Excel 数据中的数据是否在系统中存在，如果系统中已存在，则对其更新。 ")]),e("li",[t._v(" 导入类型说明：判断是更新或添加，如果添加则对必填列验证，如果更新必填列则不验证，非必填列可删除，如不删除则以当列值(含空值)更新。 ")]),e("li",[t._v(" 如果有直接上级或助理，则所填内容必须为此上级或助理的重复验证字段的值(编号、登录名、姓名选择其一)。 ")]),e("li",[t._v(" 账号类型若为主账号，则主账号无需填写；若为次账号，则主账号必须为重复验证字段的值(编号、登录名、姓名选择其一)。 ")]),e("li",[t._v(" 分部和部门的层级关系用字符“>”分割，同属一个分部和部门的可以只写第一行，但是禁止排序。 ")])])])])])],1),e("div",{attrs:{flex:"",jsb:"","mt-lg":"","md-mt":"","pr-xl":"","xl-pr":"","pl-lg":"","xl-pl":""}},[e("div",[t.deletable&&0!==t.stat.list.currentUserId?e("btn",{attrs:{sm:"",outlined:"",red:"",lighten:"","pb-xs":"",pending:t.stat.dept.pending},on:{click:function(e){t.stat.user.deleteConfirm=!0}}},[t._v(" 删除 ")]):t._e()],1),e("div",{attrs:{flex:"",ac:""}},[e("btn",{attrs:{sm:"",flat:"",grey:"",bg:"","mr-xl":""},on:{click:t.close}},[t._v("取消")]),e("btn",{attrs:{sm:"",flat:"",grey:"",bg:"","mr-xl":""}},[t._v("暂存")]),e("btn",{attrs:{sm:"",flat:"",blue:"",bg:""},on:{click:t.submit}},[t._v("提交")])],1)]),e("div",{attrs:{"ht-14":"",fill:""}}),e("modal",{attrs:{relative:"","z-index-1":"",persistent:"",noselect:""},model:{value:t.stat.user.deleteConfirm,callback:function(e){t.$set(t.stat.user,"deleteConfirm",e)},expression:"stat.user.deleteConfirm"}},[e("p",{attrs:{lg:"",catskill:"",lighten:"",bold:"","ls-sm":""}},[t._v(" "+t._s("确认要删除【"+t.getUserNameBy(t.stat.list.currentUserId)+"】吗？ 请谨慎操作，删除成员涉及很多功能")+" ")]),e("div",{attrs:{flex:"",je:"",ac:"","mt-xl":"","md-mt":"","py-xl":""}},[e("btn",{attrs:{sm:"","py-sm":"","px-xl":"",outlined:"",red:"",lighten:"","mr-xl":"","md-mr":"","no-text-shadow":"",pending:t.stat.user.pending},on:{click:function(e){return t.remove(t.stat.list.current)}}},[t._v(" 删除 ")]),e("btn",{attrs:{sm:"","py-sm":"","px-xl":"",outlined:"",green:"","no-text-shadow":""},on:{click:function(e){t.stat.user.deleteConfirm=!1}}},[t._v("返回")])],1)])],1):t._e()])},l=[],r=a(9199),i=a(2746),d=a.p+"img/img_default.360cb56e.jpg",n={name:"userManagementCrew",mixins:[r.A],inject:["data","stat","snap","api"],props:["getUsers"],created(){this.data.user.portrait=this.defaultImg},data(){return{importData:{typeName:"新增",typeIndex:0,fileData:""},defaultImg:d,dotCheckAddon:i["default"]}},computed:{deletable(){return this.$store.state.devOption.user.deletable}},watch:{"stat.user.valid":{handler:function(t){if(t){if("update"===this.stat.user.action)for(let e in this.data.user)this.stat.list.current[e]&&(this.data.user[e]=this.stat.list.current[e].toString())}else this.reset()}}},methods:{submit(){["online","deptId","sexIndex","superiorId","roleIndex"].forEach((t=>{this.data.user[t]=Number(this.data.user[t])}));let t="update"===this.stat.user.action?"put":"post",e="update"===this.stat.user.action?"/"+this.stat.list.current.id:"";this.$http[t](this.api.user+e,this.data.user).then((e=>{if(200===e.status){let e=this.data.user.username+"-"+this.data.user.fullName;this.$hint("成员【"+e+"】已"+("post"===t?"添加":"更新")),this.getUsers(),this.reset()}else this.$hint({innerHTML:"操作失败，请重试",color:"red"})}))},remove(t){this.$http.delete(this.api.user+"/"+t.id).then((t=>{if(1===t.data){let t=this.data.user.username+"-"+this.data.user.fullName;this.$hint("成员【"+t+"】已删除"),this.getUsers(),this.reset()}else this.$hint({innerHTML:"操作失败，请重试",color:"red"})}))},getUserNameBy(t){},httpRequest(t){let e=this,a=new FileReader;a.readAsDataURL(t.file),a.onloadend=function(t){e.data.user.portrait=this.result}},beforeAvatarUpload(t){const e=t.size/1024/1024<4;return e||this.$hint({innerHTML:"上传头像图片大小不能超过 4MB!",color:"red"}),e},hotkey_Escape(){this.stat.user.valid=!1},select(t){this.data.user.deptLevel=t.level+t.id+".",this.data.user.deptName=t.name,this.data.user.deptId=t.id},close(){let t=setTimeout((()=>{this.stat.user.valid=!1,clearTimeout(t)}),200)},reset(){for(let t in this.data.user)this.data.user[t]=this.snap.user[t];for(let t in this.stat.user)this.stat.user[t]=this.snap.stat.user[t];this.data.user.portrait=this.defaultImg},selectImportType(t,e){this.importData.typeIndex=e},resetPortrait(){this.data.user.portrait=d}}},o=n,c=a(1656),u=(0,c.A)(o,s,l,!1,null,"0016cfe4",null),m=u.exports},2746:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"addon-dotSelectBox",attrs:{flex:"",ac:""}},[e("div",{staticClass:"dot",class:{checked:t.value.toString()===t.state.value},attrs:{"xs-mr":"","mr-sm":""}}),e("div",{staticClass:"text",class:{checked:t.value.toString()===t.state.value},attrs:{"xs-pl":"","pl-sm":"","xs-pr":"","pr-xl":""}},[t._v(t._s(t.state.label))])])},l=[],r={name:"addon-dotCheck",inject:["state"],props:["value"]},i=r,d=a(1656),n=(0,d.A)(i,s,l,!1,null,"5a6dfb5b",null),o=n.exports}}]);